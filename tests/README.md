# ğŸ§ª æ¸¬è©¦æ–‡æª”

## æ¦‚è¿°

æœ¬é …ç›®åŒ…å«å®Œæ•´çš„æ¸¬è©¦å¥—ä»¶ï¼Œç”¨æ–¼é©—è­‰ Agentic RAG Framework çš„å„å€‹åŠŸèƒ½æ¨¡çµ„ã€‚æ¸¬è©¦åˆ†ç‚ºä¸‰å€‹ä¸»è¦é¡åˆ¥ï¼š

- **å–®å…ƒæ¸¬è©¦** (`tests/unit/`) - æ¸¬è©¦å€‹åˆ¥çµ„ä»¶åŠŸèƒ½
- **è³‡æ–™åº«æ¸¬è©¦** (`tests/database/`) - æ¸¬è©¦è³‡æ–™åº«æ“ä½œ
- **æ•´åˆæ¸¬è©¦** (`tests/integration/`) - æ¸¬è©¦å®Œæ•´å·¥ä½œæµç¨‹

## ğŸ“ æ¸¬è©¦çµæ§‹

```
tests/
â”œâ”€â”€ __init__.py                 # æ¸¬è©¦é…ç½®å’Œå…±ç”¨å·¥å…·
â”œâ”€â”€ run_tests.py               # çµ±ä¸€æ¸¬è©¦é‹è¡Œå™¨
â”œâ”€â”€ README.md                  # æœ¬æ–‡æª”
â”œâ”€â”€ unit/
â”‚   â””â”€â”€ test_crawler.py        # çˆ¬èŸ²åŠŸèƒ½å–®å…ƒæ¸¬è©¦
â”œâ”€â”€ database/
â”‚   â””â”€â”€ test_database_operations.py  # è³‡æ–™åº«æ“ä½œæ¸¬è©¦
â””â”€â”€ integration/
    â””â”€â”€ test_full_system.py    # å®Œæ•´ç³»çµ±æ•´åˆæ¸¬è©¦
```

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. ç’°å¢ƒæº–å‚™

ç¢ºä¿ä»¥ä¸‹æœå‹™æ­£åœ¨é‹è¡Œï¼š
- Supabase å®¹å™¨ (localhost:8000 æˆ– host.docker.internal:8000)
- ç¶²çµ¡é€£æ¥æ­£å¸¸

### 2. é‹è¡Œæ¸¬è©¦

```bash
# é€²å…¥æ¸¬è©¦ç›®éŒ„
cd tests

# é‹è¡Œæ‰€æœ‰æ¸¬è©¦
python run_tests.py all

# é‹è¡Œç‰¹å®šæ¸¬è©¦
python run_tests.py quick       # å¿«é€Ÿæ¸¬è©¦
python run_tests.py unit        # å–®å…ƒæ¸¬è©¦
python run_tests.py database    # è³‡æ–™åº«æ¸¬è©¦
python run_tests.py integration # æ•´åˆæ¸¬è©¦

# æŸ¥çœ‹å¹«åŠ©
python run_tests.py help
```

## ğŸ“‹ æ¸¬è©¦é¡å‹èªªæ˜

### 1. å¿«é€Ÿæ¸¬è©¦ (`quick`)

**ç”¨é€”**: å¿«é€Ÿé©—è­‰ç³»çµ±åŸºæœ¬åŠŸèƒ½
**æ™‚é–“**: ~30 ç§’
**å…§å®¹**:
- è³‡æ–™åº«é€£æ¥æ¸¬è©¦
- å–®å€‹ URL çˆ¬å–æ¸¬è©¦
- åŸºæœ¬è³‡æ–™å„²å­˜æ¸¬è©¦

**é©ç”¨å ´æ™¯**: é–‹ç™¼éç¨‹ä¸­çš„å¿«é€Ÿé©—è­‰

### 2. å–®å…ƒæ¸¬è©¦ (`unit`)

**ç”¨é€”**: æ¸¬è©¦çˆ¬èŸ²çµ„ä»¶çš„å„é …åŠŸèƒ½
**æ™‚é–“**: ~2-3 åˆ†é˜
**å…§å®¹**:
- å–®å€‹ URL çˆ¬å–
- æ‰¹é‡ URL çˆ¬å–
- éŒ¯èª¤è™•ç†æ©Ÿåˆ¶
- å…§å®¹æå–é©—è­‰
- æ€§èƒ½æ¸¬è©¦

**è¦†è“‹ç¯„åœ**:
- `spider.crawlers.simple_crawler.SimpleWebCrawler`
- çˆ¬èŸ²ä½µç™¼è™•ç†
- ç•°å¸¸æƒ…æ³è™•ç†

### 3. è³‡æ–™åº«æ¸¬è©¦ (`database`)

**ç”¨é€”**: é©—è­‰è³‡æ–™åº«æ“ä½œçš„æ­£ç¢ºæ€§
**æ™‚é–“**: ~1-2 åˆ†é˜
**å…§å®¹**:
- è³‡æ–™åº«é€£æ¥æ¸¬è©¦
- è¡¨æ ¼è¨ªå•é©—è­‰
- ç›´æ¥æ’å…¥æ“ä½œ
- DatabaseOperations é¡åˆ¥æ¸¬è©¦
- æ‰¹é‡æ“ä½œæ¸¬è©¦

**è¦†è“‹ç¯„åœ**:
- `database.SupabaseClient`
- `database.DatabaseOperations`
- `database.ArticleModel`

### 4. æ•´åˆæ¸¬è©¦ (`integration`)

**ç”¨é€”**: æ¸¬è©¦å®Œæ•´çš„å·¥ä½œæµç¨‹
**æ™‚é–“**: ~3-5 åˆ†é˜
**å…§å®¹**:
- çˆ¬å–ä¸¦å„²å­˜æµç¨‹
- æ‰¹é‡çˆ¬å–ä¸¦å„²å­˜
- è³‡æ–™ä¸€è‡´æ€§é©—è­‰
- é‡è¤‡è³‡æ–™è™•ç†

**è¦†è“‹ç¯„åœ**:
- çˆ¬èŸ² + è³‡æ–™åº«å®Œæ•´æµç¨‹
- è³‡æ–™å®Œæ•´æ€§
- æ¥­å‹™é‚è¼¯é©—è­‰

### 5. å®Œæ•´æ¸¬è©¦ (`all`)

**ç”¨é€”**: é‹è¡Œæ‰€æœ‰æ¸¬è©¦å¥—ä»¶
**æ™‚é–“**: ~5-8 åˆ†é˜
**å…§å®¹**: æŒ‰é †åºåŸ·è¡Œä¸Šè¿°æ‰€æœ‰æ¸¬è©¦

## ğŸ“Š æ¸¬è©¦çµæœè§£è®€

### æˆåŠŸæ¨™æº–

- **å¿«é€Ÿæ¸¬è©¦**: 3/3 åŸºæœ¬åŠŸèƒ½æ­£å¸¸
- **å–®å…ƒæ¸¬è©¦**: â‰¥80% æ¸¬è©¦é€šé
- **è³‡æ–™åº«æ¸¬è©¦**: æ‰€æœ‰æ“ä½œæ­£å¸¸
- **æ•´åˆæ¸¬è©¦**: â‰¥75% å·¥ä½œæµç¨‹æˆåŠŸ

### å¸¸è¦‹å•é¡Œ

#### 1. è³‡æ–™åº«é€£æ¥å¤±æ•—
```
âŒ è³‡æ–™åº«é€£æ¥å¤±æ•—
```
**è§£æ±ºæ–¹æ¡ˆ**:
- æª¢æŸ¥ Supabase å®¹å™¨æ˜¯å¦é‹è¡Œ
- ç¢ºèªé…ç½®ä¸­çš„ URL æ­£ç¢º (host.docker.internal:8000)
- é©—è­‰ç¶²çµ¡é€£æ¥

#### 2. çˆ¬èŸ²æ¸¬è©¦å¤±æ•—
```
âŒ å–® URL çˆ¬å– FAIL
```
**è§£æ±ºæ–¹æ¡ˆ**:
- æª¢æŸ¥ç¶²çµ¡é€£æ¥
- ç¢ºèªæ¸¬è©¦ URL å¯è¨ªå•
- æª¢æŸ¥é˜²ç«ç‰†è¨­ç½®

#### 3. è³‡æ–™åº«å¯«å…¥å¤±æ•—
```
âŒ DatabaseOperations å¯«å…¥å¤±æ•—
```
**è§£æ±ºæ–¹æ¡ˆ**:
- ç¢ºèªè³‡æ–™åº«è¡¨æ ¼å·²å‰µå»º
- æª¢æŸ¥æ¬Šé™è¨­ç½®
- é‹è¡Œ `python init_database.py`

## ğŸ”§ è‡ªå®šç¾©æ¸¬è©¦

### æ·»åŠ æ–°çš„æ¸¬è©¦ URL

ç·¨è¼¯ `tests/__init__.py`:
```python
TEST_URLS = [
    "https://your-test-url.com",
    # ... å…¶ä»– URL
]
```

### ä¿®æ”¹æ¸¬è©¦é…ç½®

ç·¨è¼¯ `tests/__init__.py`:
```python
TEST_CONFIG = {
    "max_concurrent": 5,        # ä½µç™¼æ•¸
    "timeout": 60,              # è¶…æ™‚æ™‚é–“
    "retry_attempts": 3,        # é‡è©¦æ¬¡æ•¸
    "test_batch_size": 10       # æ‰¹é‡å¤§å°
}
```

### å‰µå»ºæ–°çš„æ¸¬è©¦æ–‡ä»¶

1. åœ¨é©ç•¶çš„å­ç›®éŒ„å‰µå»º `.py` æ–‡ä»¶
2. ç¹¼æ‰¿æ¸¬è©¦åŸºé¡æˆ–ä½¿ç”¨å…±ç”¨å·¥å…·
3. ä½¿ç”¨ `print_test_result()` å ±å‘Šçµæœ
4. åœ¨ `run_tests.py` ä¸­è¨»å†Šæ–°æ¸¬è©¦

## ğŸ“ˆ æŒçºŒæ•´åˆ

### åœ¨ CI/CD ä¸­ä½¿ç”¨

```bash
# åªé‹è¡Œå¿«é€Ÿæ¸¬è©¦
python tests/run_tests.py quick

# é‹è¡Œå®Œæ•´æ¸¬è©¦å¥—ä»¶
python tests/run_tests.py all
```

### æ¸¬è©¦è¦†è“‹ç‡

å»ºè­°å®šæœŸé‹è¡Œå®Œæ•´æ¸¬è©¦å¥—ä»¶ä»¥ç¢ºä¿ï¼š
- æ‰€æœ‰åŠŸèƒ½æ¨¡çµ„æ­£å¸¸å·¥ä½œ
- æ–°çš„ä»£ç¢¼è®Šæ›´ä¸ç ´å£ç¾æœ‰åŠŸèƒ½
- ç³»çµ±åœ¨ä¸åŒç’°å¢ƒä¸‹çš„ç©©å®šæ€§

## ğŸ› ï¸ æ•…éšœæ’é™¤

### èª¿è©¦æ¨¡å¼

è¨­ç½®ç’°å¢ƒè®Šæ•¸ä»¥ç²å¾—æ›´è©³ç´°çš„æ—¥èªŒï¼š
```bash
export PYTHONPATH=.
export LOG_LEVEL=DEBUG
python tests/run_tests.py [test_type]
```

### æ‰‹å‹•æ¸¬è©¦æ­¥é©Ÿ

å¦‚æœè‡ªå‹•æ¸¬è©¦å¤±æ•—ï¼Œå¯ä»¥æ‰‹å‹•é©—è­‰ï¼š

1. **è³‡æ–™åº«é€£æ¥**:
   ```python
   from database import SupabaseClient
   client = SupabaseClient()
   print(client.connect())
   ```

2. **çˆ¬èŸ²åŠŸèƒ½**:
   ```python
   import asyncio
   from spider.crawlers.simple_crawler import SimpleWebCrawler
   
   async def test():
       async with SimpleWebCrawler() as crawler:
           result = await crawler.crawl_url("https://example.com")
           print(result.success, result.title)
   
   asyncio.run(test())
   ```

3. **è³‡æ–™åº«æ“ä½œ**:
   ```python
   from database import DatabaseOperations, ArticleModel
   
   client = SupabaseClient()
   client.connect()
   ops = DatabaseOperations(client)
   
   article = ArticleModel(url="test", title="test", content="test")
   print(ops.create_article(article))
   ```

## ğŸ“ æ”¯æ´

å¦‚æœé‡åˆ°æ¸¬è©¦å•é¡Œï¼š
1. æª¢æŸ¥æœ¬æ–‡æª”çš„æ•…éšœæ’é™¤éƒ¨åˆ†
2. ç¢ºèªç’°å¢ƒé…ç½®æ­£ç¢º
3. æŸ¥çœ‹è©³ç´°çš„éŒ¯èª¤æ—¥èªŒ
4. å˜—è©¦æ‰‹å‹•æ¸¬è©¦æ­¥é©Ÿ
